# utils/lista_mercado.py

def obtener_lista_mercado_fit():
    return {
        "Proteínas Animales": [
            "Pechuga de pollo",
            "Muslos de pollo sin piel",
            "Carne magra de res (lomo, cuadril, bola)",
            "Hígado de res",
            "Carne molida magra",
            "Pavo molido o en filetes",
            "Pescado tilapia",
            "Pescado atún (fresco o enlatado en agua)",
            "Sardinas en lata",
            "Salmón (fresco o enlatado)",
            "Huevos enteros"
            "Claras de huevo",
            "Queso cottage bajo en grasa",
            "Queso fresco bajo en grasa (cuajada, ricotta light)",
            "Yogur griego natural sin azúcar",
            "Leche semidescremada o descremada",
            "Leche deslactosada alta en proteína",
            "Kéfir natural sin azúcar",
            "Jamón de pavo sin conservantes",
            "Lomo canadiense",
            "Mariscos (camarones, calamares, mejillones)"
        ],
        "Carbohidratos complejos": [
            # Carbohidratos complejos comunes en Colombia y Latinoamérica
            "Arroz integral",
            "Avena en hojuelas",
            "Yuca cocida",
            "Ñame cocido",
            "Papa criolla cocida",
            "Papa blanca cocida",
            "Camote (batata) cocido",
            "Arepas de maíz 100% natural",
            "Arepas integrales",
            "Pan de masa madre",
            "Pan de centeno",
            "Tortillas de maíz integral",
            "Plátano verde hervido o al horno",
            "Plátano maduro asado",
            "Cebada perlada cocida",
            "Quinua cocida",
            "Lentejas cocidas",
            "Frijoles rojos o cargamanto cocidos",
            "Frijol negro cocido",
            "Garbanzo cocido",
            "Maíz tierno cocido",
            "Pasta integral",
            "Tostadas de arroz integral",
            "Harina de avena",
            "Farina de maíz (precocida natural)",
            "Arvejas cocidas",
            "Habas cocidas",
            "Choclo o mazorca",
            "Cuscús integral"
        ],
        "Grasas saludables": [
            # Grasas saludables comunes
            "Aguacate (palta)",
            "Maní natural o tostado sin sal",
            "Almendras",
            "Nueces",
            "Semillas de chía",
            "Semillas de linaza",
            "Semillas de ajonjolí (sésamo)",
            "Mantequilla de maní natural sin azúcar",
            "Mantequilla de almendras natural",
            "Aceite de oliva extra virgen",
            "Aceite de coco (en pequeñas cantidades)",
            "Aceite de aguacate",
            "Aceitunas verdes o negras",
            "Coco rallado sin azúcar",
            "Leche de almendras sin azúcar",
            "Leche de coco sin azúcar",
            "Leche de soya natural",
            "Huevo entero (por su yema saludable)",
            "Yogur griego entero (en porción moderada)",
            "Nueces de Brasil",
            "Nueces de macadamia",
            "Semillas de girasol",
            "Semillas de calabaza (pepitas)",
            "Mantequilla de semillas de girasol natural",
            "Mantequilla de anacardos (cashews)",
            "Aceite de linaza (ideal para ensaladas)",
            "Aceite de sacha inchi (rico en omega-3)",
            "Aceite de nuez",
            "Aceite de ajonjolí (sésamo)",
            "Queso de cabra bajo en grasa",
            "Tofu (fuente de grasa y proteína vegetal)",
            "Edamame (soya tierna cocida)",
            "Chocolate amargo (+85% cacao, sin azúcar añadida)",
            "Harina de almendra",
            "Crema de coco sin azúcar",
            "Yema de huevo",
            "Aceitunas rellenas (moderadamente)",
            "Productos con omega-3 (pescados grasos: salmón, sardina, atún)"
        ],
        "Vegetales y fibra": [
            # Vegetales y fuentes de fibra
            "Espinaca fresca o congelada",
            "Acelga",
            "Lechuga romana o crespa",
            "Repollo blanco o morado",
            "Col rizada (kale) si disponible",
            "Brócoli",
            "Coliflor",
            "Zanahoria",
            "Pepino",
            "Calabacín (zucchini)",
            "Tomate",
            "Tomate cherry",
            "Remolacha",
            "Cebolla blanca o roja",
            "Pimentón rojo, verde o amarillo",
            "Ajo",
            "Apio",
            "Espárragos",
            "Berenjena",
            "Chayote (cidra)",
            "Habichuelas (ejotes)",
            "Arveja verde",
            "Champiñones frescos o en conserva",
            "Alcachofas (si se consiguen)",
            "Maíz tierno en mazorca (con moderación)",
            "Raíces como ñame o yuca (fibra resistente)",
            "Pan integral 100% con fibra",
            "Salvado de trigo o avena",
            "Harina de coco (alta en fibra)",
            "Semillas de chía (super ricas en fibra)",
            "Semillas de lino (linaza)"
        ],
        "Frutas": [
            # Frutas (aptas para dietas fitness y equilibradas)
            "Banano (ideal para pre/post entreno)",
            "Manzana roja o verde",
            "Pera",
            "Papaya",
            "Piña",
            "Sandía",
            "Melón",
            "Mango maduro (en porciones moderadas)",
            "Uvas (con moderación)",
            "Fresas",
            "Moras",
            "Arándanos (frescos o congelados)",
            "Ciruelas",
            "Duraznos",
            "Mandarina",
            "Naranja",
            "Granadilla",
            "Maracuyá",
            "Guayaba",
            "Tamarindo (sin azúcar añadida)",
            "Lulo (ideal para jugos naturales)",
            "Chontaduro (con miel o limón, moderado)",
            "Carambolo",
            "Higos secos (en pequeña cantidad)",
            "Fruta deshidratada sin azúcar (fresa, mango, piña)",
            "Fruta congelada para smoothies"
            "Mango biche",
            "Curuba",
            "Tamarindo",
            "Tomate de árbol",
            "Ciruela",
            "Durazno",
            "Feijoa",
            "Cereza silvestre",
            "Limón tahití",
            "Limón mandarina",
            "Coco natural",
            "Guanábana",
            "Zapote",
            "Anón",
            "Chontaduro (sin sal y sin miel para versión fit)",
            "Higo",
            "Níspero",
            "Arazá (región Amazónica)",
            "Borojó (excelente en batidos pre-entreno)",
            "Badea"
        ],
        "Extras básicos": [
            "Agua sin gas",
            "Agua con gas sin azúcar",
            "Sal rosada del Himalaya",
            "Café negro sin azúcar",
            "Té verde en bolsitas",
            "Té de manzanilla sin azúcar",
            "Té de frutos rojos sin azúcar",
            "Té matcha en polvo",
            "Vinagre de manzana",
            "Vinagre balsámico sin azúcar",
            "Aceite en spray (de coco o canola)",
            "Stevia líquida o en sobres",
            "Eritritol o monk fruit (endulzantes naturales)",
            "Mostaza sin azúcar",
            "Pimienta negra",
            "Canela en polvo",
            "Cúrcuma en polvo",
            "Jengibre en polvo",
            "Ajo en polvo",
            "Orégano seco",
            "Comino molido",
            "Hierbas finas deshidratadas",
            "Salsa de soya baja en sodio",
            "Salsa picante natural (tipo Tabasco, sin azúcar)",
            "Gelatina sin azúcar",
            "Cocoa en polvo sin azúcar",
            "Leche vegetal sin azúcar (almendra, coco, soya)",
            "Galletas de arroz sin sal",
            "Tortillas integrales light",
            "Toppings de chía o linaza",
            "Yogur natural sin azúcar en presentación pequeña",
            "Mermelada sin azúcar o baja en calorías",
            "Pasta de ajo natural",
            "Bicarbonato de sodio (para hornear saludable)",
            "Agua saborizada cero calorías (H2OH, PepsiCo Zero, etc.)",
            "Gaseosa cero (Coca-Cola Zero, Pepsi Light, etc.)",
            "Bebidas energéticas sin azúcar (Monster Zero, Red Bull Sugarfree)",
            "Bebidas isotónicas sin azúcar (Gatorade Zero, Powerade Zero)",
            "Agua de coco natural (sin azúcar añadida)",
            "Agua con electrolitos",
            "Sopas instantáneas fitness sin sodio ni grasas (tipo consomé natural en polvo)",
            "Levadura nutricional (para sabor tipo queso sin grasa)"

        ],
        "Snacks Saludables": [
            "Rodajas de pepino con limón y sal marina",
            "Palitos de zanahoria con hummus",
            "Edamames al vapor con sal baja en sodio",
            "Trozos de manzana con mantequilla de maní natural",
            "Yogur griego sin azúcar con arándanos",
            "Rollitos de pavo con palta en hojas de lechuga",
            "Batido de proteína con leche vegetal",
            "Tostadas de arroz integral con aguacate",
            "Chips de plátano horneado sin sal",
            "Barritas de proteína caseras (avena, dátiles, nueces)",
            "Huevo duro con sal y pimienta",
            "Gelatina sin azúcar con trozos de fruta",
            "Mix de nueces (almendras, nueces, anacardos) sin sal",
            "Galletas de avena y plátano sin azúcar",
            "Smoothie de espinaca, piña y leche de almendra",
            "Bolitas energéticas de avena, coco y cacao",
            "Trozos de sandía con semillas de chía",
            "Chips de manzana horneadas con canela",
            "Palomitas de maíz naturales (sin mantequilla)",
            "Pepinos rellenos de queso cottage light",
            "Pan pita integral con hummus",
            "Rodajas de tomate con aceite de oliva y albahaca",
            "Frutas deshidratadas sin azúcar (mango, manzana, piña)",
            "Pudding de chía con leche vegetal y vainilla",
            "Tortitas de avena con clara de huevo y canela",
            "Barra de proteína vegetal sin azúcar añadida",
            "Cereal integral sin azúcar con leche vegetal",
            "Papas dulces al horno en bastones (tipo snack)",
            "Trozos de queso bajo en grasa con uvas",
            "Tiras de nori (alga marina) como snack crujiente",
            "Muffins caseros de avena y zanahoria sin azúcar",
            "Zanahorias baby con crema de yogur y especias",
            "Frutos secos activados (remojados y deshidratados)",
            "Pudding de proteína en polvo y leche vegetal",
            "Smoothie bowl con frutas rojas y granola sin azúcar",
            "Ensalada rápida de frutas con semillas"
]
        
    }




import random
from utils.lista_mercado import obtener_lista_mercado_fit


def filtrar_por_restricciones(alimentos, restricciones, categoria):
    if not restricciones:
        return alimentos

    alimentos_filtrados = []
    for item in alimentos:
        item_lower = item.lower()

        # SIN GLUTEN
        if "Sin gluten" in restricciones and categoria in ["Carbohidratos complejos", "Extras básicos", "Snacks Saludables"]:
            if any(x in item_lower for x in ["pan", "harina", "avena", "cebada", "centeno", "cuscús", "tortilla", "galleta"]):
                continue

        # SIN LACTOSA
        if "Sin lactosa" in restricciones and categoria in ["Proteínas Animales", "Grasas saludables", "Snacks Saludables", "Extras básicos"]:
            if any(x in item_lower for x in ["leche", "queso", "yogur", "kéfir", "cottage", "cuajada", "ricotta", "lácteo"]):
                continue

        # VEGANO
        if "Vegano" in restricciones:
            if any(x in item_lower for x in [
                "huevo", "pollo", "carne", "res", "pavo", "pescado", "atún", "sardina", "salmón",
                "jamón", "lomo", "queso", "leche", "kéfir", "yogur", "miel", "marisco"
            ]):
                continue

        # VEGETARIANO
        if "Vegetariano" in restricciones:
            if any(x in item_lower for x in [
                "pollo", "carne", "res", "pavo", "pescado", "atún", "sardina", "salmón",
                "jamón", "marisco", "lomo canadiense"
            ]):
                continue

        # KETO
        if "Keto" in restricciones and categoria in ["Carbohidratos complejos", "Frutas"]:
            if any(x in item_lower for x in [
                "arroz", "avena", "papa", "camote", "arepa", "pan", "tortilla", "quinua", "cebada", "pasta", "yuca",
                "plátano", "choclo", "cuscús", "harina", "frijol", "lenteja", "garbanzo", "maíz", "arveja", "haba",
                "mango", "banano", "piña", "melón", "sandía", "uvas", "papaya", "tamarindo", "guayaba", "zapote"
            ]):
                continue

        # DIABÉTICO
        if "Diabético" in restricciones and categoria in ["Frutas", "Extras básicos", "Snacks Saludables"]:
            if any(x in item_lower for x in [
                "azúcar", "miel", "mermelada", "jarabe", "dulce", "gelatina", "fruta deshidratada", "cereal con azúcar",
                "banano", "mango", "piña", "sandía", "melón", "uvas", "papaya", "tamarindo", "guayaba", "higo", "zapote",
                "galleta", "barrita", "palomita", "chips", "smoothie"
            ]):
                continue

        # SIN FRUTOS SECOS
        if "Sin frutos secos" in restricciones:
            if any(x in item_lower for x in ["almendra", "maní", "nuez", "anacardo", "pistacho", "avellana", "Nueces de macadamia",
                "Nueces de Brasil", "semilla de chía", "semilla de linaza", "semilla de ajonjolí", "mantequilla de maní",
            ]):

                continue

        alimentos_filtrados.append(item)

    return alimentos_filtrados


def generar_lista_personalizada(objetivo, restricciones=None):
    lista_completa = obtener_lista_mercado_fit()

    prioridades = {
        "Volumen": {
            "Proteínas Animales": 8,
            "Carbohidratos complejos": 8,
            "Grasas saludables": 5,
            "Vegetales y fibra": 8,
            "Frutas": 3,
            "Snacks Saludables": 3,
            "Extras básicos": 5
        },
        "Definición": {
            "Proteínas Animales": 10,
            "Carbohidratos complejos": 4,
            "Grasas saludables": 3,
            "Vegetales y fibra": 8,
            "Frutas": 3,
            "Snacks Saludables": 3,
            "Extras básicos": 5
        },
        "Mantenimiento": {
            "Proteínas Animales": 6,
            "Carbohidratos complejos": 6,
            "Grasas saludables": 4,
            "Vegetales y fibra": 8,
            "Frutas": 3,
            "Snacks Saludables": 3,
            "Extras básicos": 5
        }
    }

    cantidades = prioridades.get(objetivo, prioridades["Mantenimiento"])
    lista_personalizada = {}

    for categoria, cantidad in cantidades.items():
        alimentos = lista_completa.get(categoria, [])
        alimentos = filtrar_por_restricciones(alimentos, restricciones, categoria)
        seleccion = random.sample(alimentos, min(cantidad, len(alimentos)))
        lista_personalizada[categoria] = seleccion

    return lista_personalizada
